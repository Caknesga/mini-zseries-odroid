<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hardware Monitoring</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap" rel="stylesheet">
   <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>Hardware Monitoring Dashboard</h1>

  <div class="hardware-container">
    <div class="card">
      <h3>CPU Metrics</h3>
      <p class="metric">Platform: <span id="platform">--</span></p>
      <p class="metric">CPU Load: <span id="cpu">--</span>%</p>
      <p class="metric">CPU Load per Core: <span id="per_core">--</span></p>
      <p class="metric">CPU Frequency: <span id="freq">--</span> MHz</p>
      <p class="metric">Temperature: <span id="temp">--</span> </p>
    </div>

    <div class="card">
      <h3>Memory & Disk</h3>
      <p class="metric">Memory Usage: <span id="memory">--</span></p>
      <p class="metric">Disk Usage: <span id="disk">--</span></p>
      
    </div>
  </div>


<div class="card" style="grid-column: span 2; text-align:center;">
  <h3>Transaction Generator</h3>
  <p>Enter number of random transactions to simulate:</p>
  <input type="number" id="txCount" placeholder="e.g. 10" min="1" max="1000" style="padding:8px; width:120px;">
  <button onclick="generateTransactions()" class="btn-primary">Generate</button>
  <p id="txResult" style="margin-top:10px; font-weight:600;"></p>
</div>

<div class="card" style="text-align:center;">
  <h3>ðŸ§  Simulate AI Inference</h3>
  <button class="btn-primary" onclick="startFakeAI()">Start Load</button>
  <button class="btn-secondary" onclick="stopFakeAI()">Stop Load</button>
  <p id="aiStatus" style="margin-top:10px; font-weight:600;"></p>
</div>

  <div class="nav">
    <button onclick="window.location.href='/'">Back to Dashboard</button>
  </div>

  <script>

        async function loadHardware() {
        const res = await fetch("/hardware");
        const data = await res.json();

        document.getElementById("platform").textContent = data.platform;
        document.getElementById("cpu").textContent = data.cpu_percent ;
        document.getElementById("per_core").textContent=data.per_core_cpu;
        if (data.cpu_freq) {
            document.getElementById("freq").textContent = data.cpu_freq.current;
        }

        document.getElementById("memory").textContent = data.memory_percent + "%";
        document.getElementById("disk").textContent = data.disk_percent + "%";


        document.getElementById("temp").textContent = data.temperature + "Â°C";
        

        }
        setInterval(loadHardware, 2000);

</script>

<script>
async function generateTransactions() {
  const count = parseInt(document.getElementById("txCount").value);
  const resultEl = document.getElementById("txResult");

  if (isNaN(count) || count <= 0) {
    resultEl.textContent = "âš ï¸ Please enter a valid number.";
    resultEl.style.color = "red";
    return;
  }

  try {
    const res = await fetch("/generate_transactions", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ count })
    });
    const data = await res.json();

    if (res.ok) {
      resultEl.textContent = `âœ… ${data.generated} transactions simulated successfully.`;
      resultEl.style.color = "green";
    } else {
      resultEl.textContent = `âŒ Error: ${data.error}`;
      resultEl.style.color = "red";
    }
  } catch (err) {
    console.error(err);
    resultEl.textContent = "âš ï¸ Server not reachable.";
    resultEl.style.color = "red";
  }
}
</script>

<script>
async function startFakeAI() {
  const res = await fetch("/fake_ai_start", { method: "POST" });
  const data = await res.json();
  const status = document.getElementById("aiStatus");
  status.textContent = data.status === "started" ? `Fake AI started (PID ${data.pid})` : "Already running";
  status.style.color = "green";
}

async function stopFakeAI() {
  const res = await fetch("/fake_ai_stop", { method: "POST" });
  const data = await res.json();
  const status = document.getElementById("aiStatus");
  status.textContent = "Stopped";
  status.style.color = "orange";
}
</script>

</body>
</html>
